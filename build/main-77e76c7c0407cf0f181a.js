!function(e){var t={};function i(s){if(t[s])return t[s].exports;var d=t[s]={i:s,l:!1,exports:{}};return e[s].call(d.exports,d,d.exports,i),d.l=!0,d.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t){e.exports=function(e,t,i){var s={screenWidth:640,screenHeight:480,dashSize:5,paddleLeft_x:50,paddleRight_x:590,paddleVelocity:600,paddleSegmentsMax:4,paddleSegmentHeight:24,paddleSegmentAngle:15,paddleTopGap:22,ballVelocity:500,ballRandomStartingAngleLeft:[-120,120],ballRandomStartingAngleRight:[-60,60],ballStartDelay:2,scoreToWin:3},d={ballURL:assets_url+"images/ball.png",ballName:"ball",paddleURL:assets_url+"images/paddle.png",paddleName:"paddle"},a=assets_url+"sound/ballBounce",l="ballBounce",o=assets_url+"sound/ballHit",n="ballHit",r=assets_url+"sound/ballMissed",h="ballMissed",p=".m4a",c=".ogg",u={scoreLeft_x:.25*s.screenWidth,scoreRight_x:.75*s.screenWidth,scoreTop_y:10,scoreFontStyle:{font:"80px Arial",fill:"#FFFFFF",align:"center"},instructionsFontSyle:{font:"24px Arial",fill:"#FFFFFF",align:"center"}},g="Left paddle: A to move up, Z to move down.\nRight paddle: UP and DOWN arrows keys.\n- click to start -",b="Winner!",y=function(e){this.backgroundGraphics,this.ballSprite,this.paddleLeftSprite,this.paddleRightSprite,this.paddleGroup,this.paddleLeft_up,this.paddleLeft_down,this.paddleRight_up,this.paddleRight_down,this.missedSide,this.tf_scoreLeft,this.tf_scoreRight,this.sndBallHit,this.sndBallBounce,this.sndBallMissed,this.instructions,this.winnerLeft,this.winnerRight};y.prototype={preload:function(){f.load.image(d.ballName,d.ballURL),f.load.image(d.paddleName,d.paddleURL),f.load.audio(l,[a+p,a+c]),f.load.audio(n,[o+p,o+c]),f.load.audio(h,[r+p,r+c])},create:function(){this.initGraphics(),this.initPhysics(),this.initKeyboard(),this.initSounds(),this.startDemo()},update:function(){this.moveLeftPaddle(),this.moveRightPaddle(),f.physics.arcade.overlap(this.ballSprite,this.paddleGroup,this.collideWithPaddle,null,this),(this.ballSprite.body.blocked.up||this.ballSprite.body.blocked.down||this.ballSprite.body.blocked.left||this.ballSprite.body.blocked.right)&&this.sndBallBounce.play()},initGraphics:function(){this.backgroundGraphics=f.add.graphics(0,0),this.backgroundGraphics.lineStyle(2,16777215,1);for(var e=0;e<s.screenHeight;e+=2*s.dashSize)this.backgroundGraphics.moveTo(f.world.centerX,e),this.backgroundGraphics.lineTo(f.world.centerX,e+s.dashSize);this.ballSprite=f.add.sprite(f.world.centerX,f.world.centerY,d.ballName),this.ballSprite.anchor.set(.5,.5),this.paddleLeftSprite=f.add.sprite(s.paddleLeft_x,f.world.centerY,d.paddleName),this.paddleLeftSprite.anchor.set(.5,.5),this.paddleLeftSprite.scale.y=3,this.paddleRightSprite=f.add.sprite(s.paddleRight_x,f.world.centerY,d.paddleName),this.paddleRightSprite.anchor.set(.5,.5),this.paddleRightSprite.scale.y=3,this.tf_scoreLeft=f.add.text(u.scoreLeft_x,u.scoreTop_y,"0",u.scoreFontStyle),this.tf_scoreLeft.anchor.set(.5,0),this.tf_scoreRight=f.add.text(u.scoreRight_x,u.scoreTop_y,"0",u.scoreFontStyle),this.tf_scoreRight.anchor.set(.5,0),this.instructions=this.game.add.text(this.game.world.centerX,this.game.world.centerY,g,u.instructionsFontSyle),this.instructions.anchor.set(.5,.5),this.winnerLeft=this.game.add.text(.25*s.screenWidth,.25*s.screenHeight,b,u.instructionsFontSyle),this.winnerLeft.anchor.set(.5,.5),this.winnerRight=this.game.add.text(.75*s.screenWidth,.25*s.screenHeight,b,u.instructionsFontSyle),this.winnerLeft.anchor.set(.5,.5),this.hideTextFields()},initSounds:function(){this.sndBallHit=this.game.add.audio(n),this.sndBallBounce=this.game.add.audio(l),this.sndBallMissed=this.game.add.audio(h)},initPhysics:function(){f.physics.startSystem(Phaser.Physics.ARCADE),f.physics.enable(this.ballSprite,Phaser.Physics.ARCADE),this.ballSprite.checkWorldBounds=!0,this.ballSprite.body.collideWorldBounds=!0,this.ballSprite.body.immovable=!0,this.ballSprite.body.bounce.set(1),this.paddleGroup=this.game.add.group(),this.paddleGroup.enableBody=!0,this.paddleGroup.physicsBodyType=Phaser.Physics.ARCADE,this.paddleGroup.add(this.paddleLeftSprite),this.paddleGroup.add(this.paddleRightSprite),this.paddleGroup.setAll("checkWorldBounds",!0),this.paddleGroup.setAll("body.collideWorldBounds",!0),this.paddleGroup.setAll("body.immovable",!0),this.ballSprite.events.onOutOfBounds.add(this.ballOutOfBounds,this)},initKeyboard:function(){this.paddleLeft_up=this.game.input.keyboard.addKey(Phaser.Keyboard.A),this.paddleLeft_down=this.game.input.keyboard.addKey(Phaser.Keyboard.Z),this.paddleRight_up=this.game.input.keyboard.addKey(Phaser.Keyboard.UP),this.paddleRight_down=this.game.input.keyboard.addKey(Phaser.Keyboard.DOWN)},startDemo:function(){this.resetBall(),this.enablePaddles(!1),this.enableBoundaries(!0),this.game.input.onDown.add(this.startGame,this),this.instructions.visible=!0},startGame:function(){this.game.input.onDown.remove(this.startGame,this),this.enablePaddles(!0),this.enableBoundaries(!1),this.resetBall(),this.resetScores(),this.hideTextFields()},startBall:function(){this.ballSprite.visible=!0;var e=f.rnd.pick(s.ballRandomStartingAngleRight.concat(s.ballRandomStartingAngleLeft));"right"==this.missedSide?e=this.game.rnd.pick(s.ballRandomStartingAngleRight):"left"==this.missedSide&&(e=this.game.rnd.pick(s.ballRandomStartingAngleLeft)),f.physics.arcade.velocityFromAngle(e,s.ballVelocity,this.ballSprite.body.velocity)},resetBall:function(){this.ballSprite.reset(this.game.world.centerX,this.game.rnd.between(0,s.screenHeight)),this.ballSprite.visible=!1,f.time.events.add(Phaser.Timer.SECOND*s.ballStartDelay,this.startBall,this)},enablePaddles:function(e){this.paddleGroup.setAll("visible",e),this.paddleGroup.setAll("body.enable",e),this.paddleLeft_up.enabled=e,this.paddleLeft_down.enabled=e,this.paddleRight_up.enabled=e,this.paddleRight_down.enabled=e},enableBoundaries:function(e){this.game.physics.arcade.checkCollision.left=e,this.game.physics.arcade.checkCollision.right=e},ballOutOfBounds:function(){this.ballSprite.x<0?(this.missedSide="left",this.scoreRight++):this.ballSprite.x>s.screenWidth&&(this.missedSide="right",this.scoreLeft++),this.updateScoreTextFields(),this.scoreLeft>=s.scoreToWin?(this.winnerLeft.visible=!0,this.startDemo()):this.scoreRight>=s.scoreToWin?(this.winnerRight.visible=!0,this.startDemo()):this.resetBall()},resetScores:function(){this.scoreLeft=0,this.scoreRight=0,this.updateScoreTextFields()},hideTextFields:function(){this.instructions.visible=!1,this.winnerLeft.visible=!1,this.winnerRight.visible=!1},updateScoreTextFields:function(){this.tf_scoreLeft.text=this.scoreLeft,this.tf_scoreRight.text=this.scoreRight},moveLeftPaddle:function(){this.paddleLeft_up.isDown?this.paddleLeftSprite.body.velocity.y=-s.paddleVelocity:this.paddleLeft_down.isDown?this.paddleLeftSprite.body.velocity.y=s.paddleVelocity:this.paddleLeftSprite.body.velocity.y=0,this.paddleLeftSprite.body.y<s.paddleTopGap&&(this.paddleLeftSprite.body.y=s.paddleTopGap)},moveRightPaddle:function(){this.paddleRight_up.isDown?this.paddleRightSprite.body.velocity.y=-s.paddleVelocity:this.paddleRight_down.isDown?this.paddleRightSprite.body.velocity.y=s.paddleVelocity:this.paddleRightSprite.body.velocity.y=0,this.paddleRightSprite.body.y<s.paddleTopGap&&(this.paddleRightSprite.body.y=s.paddleTopGap)},collideWithPaddle:function(e,t){var i;this.sndBallHit.play();var d=Math.floor((e.y-t.y)/s.paddleSegmentHeight);d>=s.paddleSegmentsMax?d=s.paddleSegmentsMax-1:d<=-s.paddleSegmentsMax&&(d=-(s.paddleSegmentsMax-1)),t.x<.5*s.screenWidth?(i=d*s.paddleSegmentAngle,f.physics.arcade.velocityFromAngle(i,s.ballVelocity,this.ballSprite.body.velocity)):((i=180-d*s.paddleSegmentAngle)>180&&(i-=360),f.physics.arcade.velocityFromAngle(i,s.ballVelocity,this.ballSprite.body.velocity))}};var f=new Phaser.Game(s.screenWidth,s.screenHeight,Phaser.AUTO,"game-canvas");f.state.add("main",y),f.state.start("main")}},function(e,t,i){angular.module("app.game").directive("phaserCanvas",["$window","$injector",function(e,t){var s=function(e,t,s){i(0)(e,t,s)};return{scope:{ngModel:"=",mapId:"="},template:'<div id="game-canvas"></div>',compile:function(e,t){return s}}}])},function(e,t,i){e.exports=angular.module("app.game",["ui.router"]).config(["$stateProvider",function(e){e.state("game",{url:"/game",template:"<div>        <div phaser-canvas></div>      </div>"})}]),i(1)},function(e,t,i){angular.module("app",["ui.router",i(2).name]).config(["$urlRouterProvider",function(e){e.otherwise("/game")}])}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljL2pzL3BvbmcvZ2FtZS9nYW1lX2xvZ2ljLmpzIiwid2VicGFjazovLy8uL3N0YXRpYy9qcy9wb25nL2dhbWUvZ2FtZV9jYW52YXMuanMiLCJ3ZWJwYWNrOi8vLy4vc3RhdGljL2pzL3BvbmcvZ2FtZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zdGF0aWMvanMvcG9uZy9tYWluLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJzY29wZSIsImVsZSIsImF0dHJzIiwiZ2FtZVByb3BlcnRpZXMiLCJzY3JlZW5XaWR0aCIsInNjcmVlbkhlaWdodCIsImRhc2hTaXplIiwicGFkZGxlTGVmdF94IiwicGFkZGxlUmlnaHRfeCIsInBhZGRsZVZlbG9jaXR5IiwicGFkZGxlU2VnbWVudHNNYXgiLCJwYWRkbGVTZWdtZW50SGVpZ2h0IiwicGFkZGxlU2VnbWVudEFuZ2xlIiwicGFkZGxlVG9wR2FwIiwiYmFsbFZlbG9jaXR5IiwiYmFsbFJhbmRvbVN0YXJ0aW5nQW5nbGVMZWZ0IiwiYmFsbFJhbmRvbVN0YXJ0aW5nQW5nbGVSaWdodCIsImJhbGxTdGFydERlbGF5Iiwic2NvcmVUb1dpbiIsImdyYXBoaWNBc3NldHMiLCJiYWxsVVJMIiwiYXNzZXRzX3VybCIsImJhbGxOYW1lIiwicGFkZGxlVVJMIiwicGFkZGxlTmFtZSIsInNvdW5kQXNzZXRzIiwiZm9udEFzc2V0cyIsInNjb3JlTGVmdF94Iiwic2NvcmVSaWdodF94Iiwic2NvcmVUb3BfeSIsInNjb3JlRm9udFN0eWxlIiwiZm9udCIsImZpbGwiLCJhbGlnbiIsImluc3RydWN0aW9uc0ZvbnRTeWxlIiwibGFiZWxzIiwibWFpblN0YXRlIiwiZ2FtZSIsInRoaXMiLCJiYWNrZ3JvdW5kR3JhcGhpY3MiLCJiYWxsU3ByaXRlIiwicGFkZGxlTGVmdFNwcml0ZSIsInBhZGRsZVJpZ2h0U3ByaXRlIiwicGFkZGxlR3JvdXAiLCJwYWRkbGVMZWZ0X3VwIiwicGFkZGxlTGVmdF9kb3duIiwicGFkZGxlUmlnaHRfdXAiLCJwYWRkbGVSaWdodF9kb3duIiwibWlzc2VkU2lkZSIsInRmX3Njb3JlTGVmdCIsInRmX3Njb3JlUmlnaHQiLCJzbmRCYWxsSGl0Iiwic25kQmFsbEJvdW5jZSIsInNuZEJhbGxNaXNzZWQiLCJpbnN0cnVjdGlvbnMiLCJ3aW5uZXJMZWZ0Iiwid2lubmVyUmlnaHQiLCJwcmVsb2FkIiwibG9hZCIsImltYWdlIiwiYXVkaW8iLCJjcmVhdGUiLCJpbml0R3JhcGhpY3MiLCJpbml0UGh5c2ljcyIsImluaXRLZXlib2FyZCIsImluaXRTb3VuZHMiLCJzdGFydERlbW8iLCJ1cGRhdGUiLCJtb3ZlTGVmdFBhZGRsZSIsIm1vdmVSaWdodFBhZGRsZSIsInBoeXNpY3MiLCJhcmNhZGUiLCJvdmVybGFwIiwiY29sbGlkZVdpdGhQYWRkbGUiLCJib2R5IiwiYmxvY2tlZCIsInVwIiwiZG93biIsImxlZnQiLCJyaWdodCIsInBsYXkiLCJhZGQiLCJncmFwaGljcyIsImxpbmVTdHlsZSIsInkiLCJtb3ZlVG8iLCJ3b3JsZCIsImNlbnRlclgiLCJsaW5lVG8iLCJzcHJpdGUiLCJjZW50ZXJZIiwiYW5jaG9yIiwic2V0Iiwic2NhbGUiLCJ0ZXh0IiwiaGlkZVRleHRGaWVsZHMiLCJzdGFydFN5c3RlbSIsIlBoYXNlciIsIlBoeXNpY3MiLCJBUkNBREUiLCJlbmFibGUiLCJjaGVja1dvcmxkQm91bmRzIiwiY29sbGlkZVdvcmxkQm91bmRzIiwiaW1tb3ZhYmxlIiwiYm91bmNlIiwiZ3JvdXAiLCJlbmFibGVCb2R5IiwicGh5c2ljc0JvZHlUeXBlIiwic2V0QWxsIiwiZXZlbnRzIiwib25PdXRPZkJvdW5kcyIsImJhbGxPdXRPZkJvdW5kcyIsImlucHV0Iiwia2V5Ym9hcmQiLCJhZGRLZXkiLCJLZXlib2FyZCIsIkEiLCJaIiwiVVAiLCJET1dOIiwicmVzZXRCYWxsIiwiZW5hYmxlUGFkZGxlcyIsImVuYWJsZUJvdW5kYXJpZXMiLCJvbkRvd24iLCJzdGFydEdhbWUiLCJ2aXNpYmxlIiwicmVtb3ZlIiwicmVzZXRTY29yZXMiLCJzdGFydEJhbGwiLCJyYW5kb21BbmdsZSIsInJuZCIsInBpY2siLCJjb25jYXQiLCJ2ZWxvY2l0eUZyb21BbmdsZSIsInZlbG9jaXR5IiwicmVzZXQiLCJiZXR3ZWVuIiwidGltZSIsIlRpbWVyIiwiU0VDT05EIiwiZW5hYmxlZCIsImNoZWNrQ29sbGlzaW9uIiwieCIsInNjb3JlUmlnaHQiLCJzY29yZUxlZnQiLCJ1cGRhdGVTY29yZVRleHRGaWVsZHMiLCJpc0Rvd24iLCJiYWxsIiwicGFkZGxlIiwicmV0dXJuQW5nbGUiLCJzZWdtZW50SGl0IiwiTWF0aCIsImZsb29yIiwiR2FtZSIsIkFVVE8iLCJzdGF0ZSIsInN0YXJ0IiwiYW5ndWxhciIsImRpcmVjdGl2ZSIsIiR3aW5kb3ciLCIkaW5qZWN0b3IiLCJsaW5rRm4iLCJuZ01vZGVsIiwibWFwSWQiLCJ0ZW1wbGF0ZSIsImNvbXBpbGUiLCJpRWxlIiwiaUF0dHJzIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJ1cmwiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgs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MEwsUUFBQXZMLE9BQUEsT0FDQSxZQUNBSCxFQUFBLEdBQUFXLE9BRUEwTCxRQUFBLDhCQUFBRyxHQUNBQSxFQUNBQyxVQUFBIiwiZmlsZSI6Im1haW4tNzdlNzZjN2MwNDA3Y2YwZjE4MWEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oc2NvcGUsIGVsZSwgYXR0cnMpIHtcbiAgICB2YXIgcGFkZGxlU2NhbGUgPSAzO1xuICAgIHZhciBnYW1lUHJvcGVydGllcyA9IHtcbiAgICAgICAgc2NyZWVuV2lkdGg6IDY0MCxcbiAgICAgICAgc2NyZWVuSGVpZ2h0OiA0ODAsXG5cbiAgICAgICAgZGFzaFNpemU6IDUsXG5cbiAgICAgICAgcGFkZGxlTGVmdF94OiA1MCxcbiAgICAgICAgcGFkZGxlUmlnaHRfeDogNTkwLFxuICAgICAgICBwYWRkbGVWZWxvY2l0eTogNjAwLFxuICAgICAgICBwYWRkbGVTZWdtZW50c01heDogNCxcbiAgICAgICAgcGFkZGxlU2VnbWVudEhlaWdodDogKDMyKnBhZGRsZVNjYWxlKS80LCAvLyAzMiBwaXhlbHMgKiBwYWRkbGVzY2FsZVxuICAgICAgICBwYWRkbGVTZWdtZW50QW5nbGU6IDE1LFxuICAgICAgICBwYWRkbGVUb3BHYXA6IDIyLFxuXG4gICAgICAgIGJhbGxWZWxvY2l0eTogNTAwLFxuICAgICAgICBiYWxsUmFuZG9tU3RhcnRpbmdBbmdsZUxlZnQ6IFstMTIwLCAxMjBdLFxuICAgICAgICBiYWxsUmFuZG9tU3RhcnRpbmdBbmdsZVJpZ2h0OiBbLTYwLCA2MF0sXG4gICAgICAgIGJhbGxTdGFydERlbGF5OiAyLFxuICAgICAgICBzY29yZVRvV2luOiAzXG4gICAgfTtcblxuXG4gICAgdmFyIGdyYXBoaWNBc3NldHMgPSB7XG4gICAgICAgIGJhbGxVUkw6IGFzc2V0c191cmwgKyAnaW1hZ2VzL2JhbGwucG5nJyxcbiAgICAgICAgYmFsbE5hbWU6ICdiYWxsJyxcblxuICAgICAgICBwYWRkbGVVUkw6IGFzc2V0c191cmwgKyAnaW1hZ2VzL3BhZGRsZS5wbmcnLFxuICAgICAgICBwYWRkbGVOYW1lOiAncGFkZGxlJ1xuICAgIH07XG5cbiAgICB2YXIgc291bmRBc3NldHMgPSB7XG4gICAgICAgIGJhbGxCb3VuY2VVUkw6IGFzc2V0c191cmwgKyAnc291bmQvYmFsbEJvdW5jZScsXG4gICAgICAgIGJhbGxCb3VuY2VOYW1lOiAnYmFsbEJvdW5jZScsXG5cbiAgICAgICAgYmFsbEhpdFVSTDogYXNzZXRzX3VybCArICdzb3VuZC9iYWxsSGl0JyxcbiAgICAgICAgYmFsbEhpdE5hbWU6ICdiYWxsSGl0JyxcblxuICAgICAgICBiYWxsTWlzc2VkVVJMOiBhc3NldHNfdXJsICsgJ3NvdW5kL2JhbGxNaXNzZWQnLFxuICAgICAgICBiYWxsTWlzc2VkTmFtZTogJ2JhbGxNaXNzZWQnLFxuXG4gICAgICAgIG1wNFVSTDogJy5tNGEnLFxuICAgICAgICBvZ2dVUkw6ICcub2dnJ1xuICAgIH07XG4gICAgdmFyIGZvbnRBc3NldHMgPSB7XG4gICAgICAgIHNjb3JlTGVmdF94OiBnYW1lUHJvcGVydGllcy5zY3JlZW5XaWR0aCAqIDAuMjUsXG4gICAgICAgIHNjb3JlUmlnaHRfeDogZ2FtZVByb3BlcnRpZXMuc2NyZWVuV2lkdGggKiAwLjc1LFxuICAgICAgICBzY29yZVRvcF95OiAxMCxcbiAgICAgICAgc2NvcmVGb250U3R5bGU6IHtmb250OiAnODBweCBBcmlhbCcsIGZpbGw6ICcjRkZGRkZGJywgYWxpZ246ICdjZW50ZXInfSxcbiAgICAgICAgaW5zdHJ1Y3Rpb25zRm9udFN5bGU6IHtmb250OiAnMjRweCBBcmlhbCcsIGZpbGw6ICcjRkZGRkZGJywgYWxpZ246ICdjZW50ZXInfVxuICAgIH07XG4gICAgdmFyIGxhYmVscyA9IHtcbiAgICAgICAgY2xpY2tUb1N0YXJ0OiAnTGVmdCBwYWRkbGU6IEEgdG8gbW92ZSB1cCwgWiB0byBtb3ZlIGRvd24uXFxuUmlnaHQgcGFkZGxlOiBVUCBhbmQgRE9XTiBhcnJvd3Mga2V5cy5cXG4tIGNsaWNrIHRvIHN0YXJ0IC0nLFxuICAgICAgICB3aW5uZXI6ICdXaW5uZXIhJ1xuICAgIH1cblxuXG4gICAgdmFyIG1haW5TdGF0ZSA9IGZ1bmN0aW9uKGdhbWUpIHtcbiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kR3JhcGhpY3M7XG4gICAgICAgIHRoaXMuYmFsbFNwcml0ZTtcbiAgICAgICAgdGhpcy5wYWRkbGVMZWZ0U3ByaXRlO1xuICAgICAgICB0aGlzLnBhZGRsZVJpZ2h0U3ByaXRlO1xuICAgICAgICB0aGlzLnBhZGRsZUdyb3VwO1xuXG4gICAgICAgIHRoaXMucGFkZGxlTGVmdF91cDtcbiAgICAgICAgdGhpcy5wYWRkbGVMZWZ0X2Rvd247XG4gICAgICAgIHRoaXMucGFkZGxlUmlnaHRfdXA7XG4gICAgICAgIHRoaXMucGFkZGxlUmlnaHRfZG93bjtcblxuICAgICAgICB0aGlzLm1pc3NlZFNpZGU7XG5cbiAgICAgICAgdGhpcy50Zl9zY29yZUxlZnQ7XG4gICAgICAgIHRoaXMudGZfc2NvcmVSaWdodDtcblxuICAgICAgICB0aGlzLnNuZEJhbGxIaXQ7XG4gICAgICAgIHRoaXMuc25kQmFsbEJvdW5jZTtcbiAgICAgICAgdGhpcy5zbmRCYWxsTWlzc2VkO1xuXG4gICAgICAgIHRoaXMuaW5zdHJ1Y3Rpb25zO1xuICAgICAgICB0aGlzLndpbm5lckxlZnQ7XG4gICAgICAgIHRoaXMud2lubmVyUmlnaHQ7XG5cbiAgICB9XG5cbiAgICBtYWluU3RhdGUucHJvdG90eXBlID0ge1xuICAgICAgICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBnYW1lLmxvYWQuaW1hZ2UoZ3JhcGhpY0Fzc2V0cy5iYWxsTmFtZSwgZ3JhcGhpY0Fzc2V0cy5iYWxsVVJMKTtcbiAgICAgICAgICAgIGdhbWUubG9hZC5pbWFnZShncmFwaGljQXNzZXRzLnBhZGRsZU5hbWUsIGdyYXBoaWNBc3NldHMucGFkZGxlVVJMKTtcblxuICAgICAgICAgICAgZ2FtZS5sb2FkLmF1ZGlvKHNvdW5kQXNzZXRzLmJhbGxCb3VuY2VOYW1lLCBbc291bmRBc3NldHMuYmFsbEJvdW5jZVVSTCtzb3VuZEFzc2V0cy5tcDRVUkwsIHNvdW5kQXNzZXRzLmJhbGxCb3VuY2VVUkwrc291bmRBc3NldHMub2dnVVJMXSk7XG4gICAgICAgICAgICBnYW1lLmxvYWQuYXVkaW8oc291bmRBc3NldHMuYmFsbEhpdE5hbWUsIFtzb3VuZEFzc2V0cy5iYWxsSGl0VVJMK3NvdW5kQXNzZXRzLm1wNFVSTCwgc291bmRBc3NldHMuYmFsbEhpdFVSTCtzb3VuZEFzc2V0cy5vZ2dVUkxdKTtcbiAgICAgICAgICAgIGdhbWUubG9hZC5hdWRpbyhzb3VuZEFzc2V0cy5iYWxsTWlzc2VkTmFtZSwgW3NvdW5kQXNzZXRzLmJhbGxNaXNzZWRVUkwrc291bmRBc3NldHMubXA0VVJMLCBzb3VuZEFzc2V0cy5iYWxsTWlzc2VkVVJMK3NvdW5kQXNzZXRzLm9nZ1VSTF0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbml0R3JhcGhpY3MoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdFBoeXNpY3MoKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdEtleWJvYXJkKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRTb3VuZHMoKTtcbiAgICAgICAgICAgIHRoaXMuc3RhcnREZW1vKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLm1vdmVMZWZ0UGFkZGxlKCk7XG4gICAgICAgICAgICB0aGlzLm1vdmVSaWdodFBhZGRsZSgpO1xuICAgICAgICAgICAgZ2FtZS5waHlzaWNzLmFyY2FkZS5vdmVybGFwKHRoaXMuYmFsbFNwcml0ZSwgdGhpcy5wYWRkbGVHcm91cCwgdGhpcy5jb2xsaWRlV2l0aFBhZGRsZSwgbnVsbCwgdGhpcyk7XG4gICAgICAgICAgICBpZih0aGlzLmJhbGxTcHJpdGUuYm9keS5ibG9ja2VkLnVwIHx8IHRoaXMuYmFsbFNwcml0ZS5ib2R5LmJsb2NrZWQuZG93biB8fCB0aGlzLmJhbGxTcHJpdGUuYm9keS5ibG9ja2VkLmxlZnQgfHwgdGhpcy5iYWxsU3ByaXRlLmJvZHkuYmxvY2tlZC5yaWdodCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc25kQmFsbEJvdW5jZS5wbGF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdEdyYXBoaWNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmJhY2tncm91bmRHcmFwaGljcyA9IGdhbWUuYWRkLmdyYXBoaWNzKDAsIDApO1xuICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kR3JhcGhpY3MubGluZVN0eWxlKDIsIDB4RkZGRkZGLCAxKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBnYW1lUHJvcGVydGllcy5zY3JlZW5IZWlnaHQ7IHkgKz0gZ2FtZVByb3BlcnRpZXMuZGFzaFNpemUgKiAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kR3JhcGhpY3MubW92ZVRvKGdhbWUud29ybGQuY2VudGVyWCwgeSk7XG4gICAgICAgICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kR3JhcGhpY3MubGluZVRvKGdhbWUud29ybGQuY2VudGVyWCwgeSArIGdhbWVQcm9wZXJ0aWVzLmRhc2hTaXplKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5iYWxsU3ByaXRlID0gZ2FtZS5hZGQuc3ByaXRlKGdhbWUud29ybGQuY2VudGVyWCwgZ2FtZS53b3JsZC5jZW50ZXJZLCBncmFwaGljQXNzZXRzLmJhbGxOYW1lKTtcbiAgICAgICAgICAgIHRoaXMuYmFsbFNwcml0ZS5hbmNob3Iuc2V0KDAuNSwgMC41KTtcblxuICAgICAgICAgICAgdGhpcy5wYWRkbGVMZWZ0U3ByaXRlID0gZ2FtZS5hZGQuc3ByaXRlKGdhbWVQcm9wZXJ0aWVzLnBhZGRsZUxlZnRfeCwgZ2FtZS53b3JsZC5jZW50ZXJZLCBncmFwaGljQXNzZXRzLnBhZGRsZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy5wYWRkbGVMZWZ0U3ByaXRlLmFuY2hvci5zZXQoMC41LCAwLjUpO1xuICAgICAgICAgICAgdGhpcy5wYWRkbGVMZWZ0U3ByaXRlLnNjYWxlLnkgPSBwYWRkbGVTY2FsZTtcblxuICAgICAgICAgICAgdGhpcy5wYWRkbGVSaWdodFNwcml0ZSA9IGdhbWUuYWRkLnNwcml0ZShnYW1lUHJvcGVydGllcy5wYWRkbGVSaWdodF94LCBnYW1lLndvcmxkLmNlbnRlclksIGdyYXBoaWNBc3NldHMucGFkZGxlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZVJpZ2h0U3ByaXRlLmFuY2hvci5zZXQoMC41LCAwLjUpO1xuICAgICAgICAgICAgdGhpcy5wYWRkbGVSaWdodFNwcml0ZS5zY2FsZS55ID0gcGFkZGxlU2NhbGU7XG5cbiAgICAgICAgICAgIHRoaXMudGZfc2NvcmVMZWZ0ID0gZ2FtZS5hZGQudGV4dChmb250QXNzZXRzLnNjb3JlTGVmdF94LCBmb250QXNzZXRzLnNjb3JlVG9wX3ksIFwiMFwiLCBmb250QXNzZXRzLnNjb3JlRm9udFN0eWxlKTtcbiAgICAgICAgICAgIHRoaXMudGZfc2NvcmVMZWZ0LmFuY2hvci5zZXQoMC41LDApO1xuXG4gICAgICAgICAgICB0aGlzLnRmX3Njb3JlUmlnaHQgPSBnYW1lLmFkZC50ZXh0KGZvbnRBc3NldHMuc2NvcmVSaWdodF94LCBmb250QXNzZXRzLnNjb3JlVG9wX3ksIFwiMFwiLCBmb250QXNzZXRzLnNjb3JlRm9udFN0eWxlKTtcbiAgICAgICAgICAgIHRoaXMudGZfc2NvcmVSaWdodC5hbmNob3Iuc2V0KDAuNSwwKTtcblxuICAgICAgICAgICAgdGhpcy5pbnN0cnVjdGlvbnMgPSB0aGlzLmdhbWUuYWRkLnRleHQodGhpcy5nYW1lLndvcmxkLmNlbnRlclgsIHRoaXMuZ2FtZS53b3JsZC5jZW50ZXJZLCBsYWJlbHMuY2xpY2tUb1N0YXJ0LCBmb250QXNzZXRzLmluc3RydWN0aW9uc0ZvbnRTeWxlKTtcbiAgICAgICAgICAgIHRoaXMuaW5zdHJ1Y3Rpb25zLmFuY2hvci5zZXQoMC41LCAwLjUpO1xuXG4gICAgICAgICAgICB0aGlzLndpbm5lckxlZnQgPSB0aGlzLmdhbWUuYWRkLnRleHQoZ2FtZVByb3BlcnRpZXMuc2NyZWVuV2lkdGgqMC4yNSwgZ2FtZVByb3BlcnRpZXMuc2NyZWVuSGVpZ2h0KjAuMjUsIGxhYmVscy53aW5uZXIsIGZvbnRBc3NldHMuaW5zdHJ1Y3Rpb25zRm9udFN5bGUpO1xuICAgICAgICAgICAgdGhpcy53aW5uZXJMZWZ0LmFuY2hvci5zZXQoMC41LDAuNSk7XG5cbiAgICAgICAgICAgIHRoaXMud2lubmVyUmlnaHQgPSB0aGlzLmdhbWUuYWRkLnRleHQoZ2FtZVByb3BlcnRpZXMuc2NyZWVuV2lkdGgqMC43NSwgZ2FtZVByb3BlcnRpZXMuc2NyZWVuSGVpZ2h0KjAuMjUsIGxhYmVscy53aW5uZXIsIGZvbnRBc3NldHMuaW5zdHJ1Y3Rpb25zRm9udFN5bGUpO1xuICAgICAgICAgICAgdGhpcy53aW5uZXJMZWZ0LmFuY2hvci5zZXQoMC41LDAuNSk7XG4gICAgICAgICAgICB0aGlzLmhpZGVUZXh0RmllbGRzKCk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgaW5pdFNvdW5kczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNuZEJhbGxIaXQgPSB0aGlzLmdhbWUuYWRkLmF1ZGlvKHNvdW5kQXNzZXRzLmJhbGxIaXROYW1lKTtcbiAgICAgICAgICAgIHRoaXMuc25kQmFsbEJvdW5jZSA9IHRoaXMuZ2FtZS5hZGQuYXVkaW8oc291bmRBc3NldHMuYmFsbEJvdW5jZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy5zbmRCYWxsTWlzc2VkID0gdGhpcy5nYW1lLmFkZC5hdWRpbyhzb3VuZEFzc2V0cy5iYWxsTWlzc2VkTmFtZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdFBoeXNpY3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGdhbWUucGh5c2ljcy5zdGFydFN5c3RlbShQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuICAgICAgICAgICAgZ2FtZS5waHlzaWNzLmVuYWJsZSh0aGlzLmJhbGxTcHJpdGUsIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG5cbiAgICAgICAgICAgIHRoaXMuYmFsbFNwcml0ZS5jaGVja1dvcmxkQm91bmRzID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYmFsbFNwcml0ZS5ib2R5LmNvbGxpZGVXb3JsZEJvdW5kcyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmJhbGxTcHJpdGUuYm9keS5pbW1vdmFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5iYWxsU3ByaXRlLmJvZHkuYm91bmNlLnNldCgxKTtcblxuICAgICAgICAgICAgdGhpcy5wYWRkbGVHcm91cCA9IHRoaXMuZ2FtZS5hZGQuZ3JvdXAoKTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlR3JvdXAuZW5hYmxlQm9keSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZUdyb3VwLnBoeXNpY3NCb2R5VHlwZSA9IFBoYXNlci5QaHlzaWNzLkFSQ0FERTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlR3JvdXAuYWRkKHRoaXMucGFkZGxlTGVmdFNwcml0ZSk7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZUdyb3VwLmFkZCh0aGlzLnBhZGRsZVJpZ2h0U3ByaXRlKTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlR3JvdXAuc2V0QWxsKCdjaGVja1dvcmxkQm91bmRzJywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZUdyb3VwLnNldEFsbCgnYm9keS5jb2xsaWRlV29ybGRCb3VuZHMnLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlR3JvdXAuc2V0QWxsKCdib2R5LmltbW92YWJsZScsIHRydWUpO1xuXG4gICAgICAgICAgICB0aGlzLmJhbGxTcHJpdGUuZXZlbnRzLm9uT3V0T2ZCb3VuZHMuYWRkKHRoaXMuYmFsbE91dE9mQm91bmRzLCB0aGlzKTtcblxuXG4gICAgICAgIH0sXG4gICAgICAgIGluaXRLZXlib2FyZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZUxlZnRfdXAgPSB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5LZXlib2FyZC5BKTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlTGVmdF9kb3duID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuWik7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZVJpZ2h0X3VwID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuVVApO1xuICAgICAgICAgICAgdGhpcy5wYWRkbGVSaWdodF9kb3duID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuRE9XTik7XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0RGVtbzogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldEJhbGwoKTtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlUGFkZGxlcyhmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmVuYWJsZUJvdW5kYXJpZXModHJ1ZSk7IC8vIGJhbGwgaGl0cyB0aGUgd2FsbFxuICAgICAgICAgICAgdGhpcy5nYW1lLmlucHV0Lm9uRG93bi5hZGQodGhpcy5zdGFydEdhbWUsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5pbnN0cnVjdGlvbnMudmlzaWJsZSA9IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0R2FtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLmlucHV0Lm9uRG93bi5yZW1vdmUodGhpcy5zdGFydEdhbWUsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlUGFkZGxlcyh0cnVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVuYWJsZUJvdW5kYXJpZXMoZmFsc2UpOyAvLyB0aGVyZSBhcmUgbGVmdCBhbmQgcmlnaHQgd2FsbHNcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0QmFsbCgpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRTY29yZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVUZXh0RmllbGRzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIHN0YXJ0QmFsbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5iYWxsU3ByaXRlLnZpc2libGUgPSB0cnVlO1xuXG4gICAgICAgICAgICB2YXIgcmFuZG9tQW5nbGUgPSBnYW1lLnJuZC5waWNrKGdhbWVQcm9wZXJ0aWVzLmJhbGxSYW5kb21TdGFydGluZ0FuZ2xlUmlnaHQuY29uY2F0KGdhbWVQcm9wZXJ0aWVzLmJhbGxSYW5kb21TdGFydGluZ0FuZ2xlTGVmdCkpO1xuICAgICAgICAgICAgaWYodGhpcy5taXNzZWRTaWRlID09ICdyaWdodCcpIHtcbiAgICAgICAgICAgICAgICByYW5kb21BbmdsZSA9IHRoaXMuZ2FtZS5ybmQucGljayhnYW1lUHJvcGVydGllcy5iYWxsUmFuZG9tU3RhcnRpbmdBbmdsZVJpZ2h0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLm1pc3NlZFNpZGUgPT0gJ2xlZnQnKSB7XG4gICAgICAgICAgICAgICAgcmFuZG9tQW5nbGUgPSB0aGlzLmdhbWUucm5kLnBpY2soZ2FtZVByb3BlcnRpZXMuYmFsbFJhbmRvbVN0YXJ0aW5nQW5nbGVMZWZ0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdhbWUucGh5c2ljcy5hcmNhZGUudmVsb2NpdHlGcm9tQW5nbGUocmFuZG9tQW5nbGUsIGdhbWVQcm9wZXJ0aWVzLmJhbGxWZWxvY2l0eSwgdGhpcy5iYWxsU3ByaXRlLmJvZHkudmVsb2NpdHkpO1xuICAgICAgICB9LFxuICAgICAgICByZXNldEJhbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5iYWxsU3ByaXRlLnJlc2V0KHRoaXMuZ2FtZS53b3JsZC5jZW50ZXJYLCB0aGlzLmdhbWUucm5kLmJldHdlZW4oMCxnYW1lUHJvcGVydGllcy5zY3JlZW5IZWlnaHQpKTtcbiAgICAgICAgICAgIHRoaXMuYmFsbFNwcml0ZS52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICBnYW1lLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogZ2FtZVByb3BlcnRpZXMuYmFsbFN0YXJ0RGVsYXksIHRoaXMuc3RhcnRCYWxsLCB0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW5hYmxlUGFkZGxlczogZnVuY3Rpb24oZW5hYmxlZCkge1xuICAgICAgICAgICAgdGhpcy5wYWRkbGVHcm91cC5zZXRBbGwoJ3Zpc2libGUnLCBlbmFibGVkKTtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlR3JvdXAuc2V0QWxsKCdib2R5LmVuYWJsZScsIGVuYWJsZWQpO1xuXG4gICAgICAgICAgICB0aGlzLnBhZGRsZUxlZnRfdXAuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZUxlZnRfZG93bi5lbmFibGVkID0gZW5hYmxlZDtcbiAgICAgICAgICAgIHRoaXMucGFkZGxlUmlnaHRfdXAuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgICAgICB0aGlzLnBhZGRsZVJpZ2h0X2Rvd24uZW5hYmxlZCA9IGVuYWJsZWQ7XG5cbiAgICAgICAgfSxcbiAgICAgICAgZW5hYmxlQm91bmRhcmllczogZnVuY3Rpb24oZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5jaGVja0NvbGxpc2lvbi5sZWZ0ID0gZW5hYmxlZDsgLy8gdGhlIGxlZnQgYm91bmRhcnlcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUuY2hlY2tDb2xsaXNpb24ucmlnaHQgPSBlbmFibGVkOyAvLyB0aGUgcmlnaHQgYm91bmRhcnlcbiAgICAgICAgfSxcbiAgICAgICAgYmFsbE91dE9mQm91bmRzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZih0aGlzLmJhbGxTcHJpdGUueCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5taXNzZWRTaWRlID0gJ2xlZnQnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlUmlnaHQrKztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYodGhpcy5iYWxsU3ByaXRlLnggPiBnYW1lUHJvcGVydGllcy5zY3JlZW5XaWR0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1pc3NlZFNpZGUgPSAncmlnaHQnO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNjb3JlTGVmdCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNjb3JlVGV4dEZpZWxkcygpO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuc2NvcmVMZWZ0ID49IGdhbWVQcm9wZXJ0aWVzLnNjb3JlVG9XaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy53aW5uZXJMZWZ0LnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0RGVtbygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLnNjb3JlUmlnaHQgPj0gZ2FtZVByb3BlcnRpZXMuc2NvcmVUb1dpbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndpbm5lclJpZ2h0LnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0RGVtbygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRCYWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNldFNjb3JlczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGlzLnNjb3JlTGVmdCA9IDA7XG4gICAgICAgICAgICB0aGlzLnNjb3JlUmlnaHQgPSAwO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTY29yZVRleHRGaWVsZHMoKTtcbiAgICAgICAgfSxcbiAgICAgICAgaGlkZVRleHRGaWVsZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy5pbnN0cnVjdGlvbnMudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy53aW5uZXJMZWZ0LnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMud2lubmVyUmlnaHQudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVTY29yZVRleHRGaWVsZHM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdGhpcy50Zl9zY29yZUxlZnQudGV4dCA9IHRoaXMuc2NvcmVMZWZ0O1xuICAgICAgICAgICAgdGhpcy50Zl9zY29yZVJpZ2h0LnRleHQgPSB0aGlzLnNjb3JlUmlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIG1vdmVMZWZ0UGFkZGxlOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmKHRoaXMucGFkZGxlTGVmdF91cC5pc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZGRsZUxlZnRTcHJpdGUuYm9keS52ZWxvY2l0eS55ID0gLWdhbWVQcm9wZXJ0aWVzLnBhZGRsZVZlbG9jaXR5O1xuICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMucGFkZGxlTGVmdF9kb3duLmlzRG93bikge1xuICAgICAgICAgICAgICAgIHRoaXMucGFkZGxlTGVmdFNwcml0ZS5ib2R5LnZlbG9jaXR5LnkgPSBnYW1lUHJvcGVydGllcy5wYWRkbGVWZWxvY2l0eTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWRkbGVMZWZ0U3ByaXRlLmJvZHkudmVsb2NpdHkueSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHRoaXMucGFkZGxlTGVmdFNwcml0ZS5ib2R5LnkgPCBnYW1lUHJvcGVydGllcy5wYWRkbGVUb3BHYXApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZGRsZUxlZnRTcHJpdGUuYm9keS55ID0gZ2FtZVByb3BlcnRpZXMucGFkZGxlVG9wR2FwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBtb3ZlUmlnaHRQYWRkbGU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYodGhpcy5wYWRkbGVSaWdodF91cC5pc0Rvd24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhZGRsZVJpZ2h0U3ByaXRlLmJvZHkudmVsb2NpdHkueSA9IC1nYW1lUHJvcGVydGllcy5wYWRkbGVWZWxvY2l0eTtcbiAgICAgICAgICAgIH0gZWxzZSBpZih0aGlzLnBhZGRsZVJpZ2h0X2Rvd24uaXNEb3duKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWRkbGVSaWdodFNwcml0ZS5ib2R5LnZlbG9jaXR5LnkgPSBnYW1lUHJvcGVydGllcy5wYWRkbGVWZWxvY2l0eTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wYWRkbGVSaWdodFNwcml0ZS5ib2R5LnZlbG9jaXR5LnkgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZih0aGlzLnBhZGRsZVJpZ2h0U3ByaXRlLmJvZHkueSA8IGdhbWVQcm9wZXJ0aWVzLnBhZGRsZVRvcEdhcCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGFkZGxlUmlnaHRTcHJpdGUuYm9keS55ID0gZ2FtZVByb3BlcnRpZXMucGFkZGxlVG9wR2FwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBjb2xsaWRlV2l0aFBhZGRsZTogZnVuY3Rpb24gKGJhbGwsIHBhZGRsZSkge1xuICAgICAgICAgICAgdGhpcy5zbmRCYWxsSGl0LnBsYXkoKTtcbiAgICAgICAgICAgIHZhciByZXR1cm5BbmdsZTtcbiAgICAgICAgICAgIHZhciBzZWdtZW50SGl0ID0gTWF0aC5mbG9vcigoYmFsbC55IC0gcGFkZGxlLnkpL2dhbWVQcm9wZXJ0aWVzLnBhZGRsZVNlZ21lbnRIZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAoc2VnbWVudEhpdCA+PSBnYW1lUHJvcGVydGllcy5wYWRkbGVTZWdtZW50c01heCkge1xuICAgICAgICAgICAgICAgIHNlZ21lbnRIaXQgPSBnYW1lUHJvcGVydGllcy5wYWRkbGVTZWdtZW50c01heCAtIDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNlZ21lbnRIaXQgPD0gLWdhbWVQcm9wZXJ0aWVzLnBhZGRsZVNlZ21lbnRzTWF4KSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudEhpdCA9IC0oZ2FtZVByb3BlcnRpZXMucGFkZGxlU2VnbWVudHNNYXggLSAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBhZGRsZS54IDwgZ2FtZVByb3BlcnRpZXMuc2NyZWVuV2lkdGggKiAwLjUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm5BbmdsZSA9IHNlZ21lbnRIaXQgKiBnYW1lUHJvcGVydGllcy5wYWRkbGVTZWdtZW50QW5nbGU7XG4gICAgICAgICAgICAgICAgZ2FtZS5waHlzaWNzLmFyY2FkZS52ZWxvY2l0eUZyb21BbmdsZShyZXR1cm5BbmdsZSwgZ2FtZVByb3BlcnRpZXMuYmFsbFZlbG9jaXR5LCB0aGlzLmJhbGxTcHJpdGUuYm9keS52ZWxvY2l0eSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybkFuZ2xlID0gMTgwIC0gKHNlZ21lbnRIaXQgKiBnYW1lUHJvcGVydGllcy5wYWRkbGVTZWdtZW50QW5nbGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXR1cm5BbmdsZSA+IDE4MCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm5BbmdsZSAtPSAzNjA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZ2FtZS5waHlzaWNzLmFyY2FkZS52ZWxvY2l0eUZyb21BbmdsZShyZXR1cm5BbmdsZSwgZ2FtZVByb3BlcnRpZXMuYmFsbFZlbG9jaXR5LCB0aGlzLmJhbGxTcHJpdGUuYm9keS52ZWxvY2l0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgfTtcblxuXG5cbiAgICB2YXIgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShnYW1lUHJvcGVydGllcy5zY3JlZW5XaWR0aCwgZ2FtZVByb3BlcnRpZXMuc2NyZWVuSGVpZ2h0LCBQaGFzZXIuQVVUTywgJ2dhbWUtY2FudmFzJyk7XG4gICAgZ2FtZS5zdGF0ZS5hZGQoJ21haW4nLCBtYWluU3RhdGUpO1xuICAgIGdhbWUuc3RhdGUuc3RhcnQoJ21haW4nKTtcbn0pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwLmdhbWUnKVxuLmRpcmVjdGl2ZSgncGhhc2VyQ2FudmFzJywgWyckd2luZG93JywnJGluamVjdG9yJywgZnVuY3Rpb24oJHdpbmRvdywgJGluamVjdG9yKSB7XG5cbiAgdmFyIGxpbmtGbiA9IGZ1bmN0aW9uKHNjb3BlLCBlbGUsIGF0dHJzICl7XG4gICAgICByZXF1aXJlKCcuL2dhbWVfbG9naWMnKShzY29wZSwgZWxlLCBhdHRycyk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgc2NvcGU6IHtcbiAgICAgIG5nTW9kZWw6ICc9JyxcbiAgICAgIG1hcElkOiAnPSdcbiAgICB9LFxuICAgIHRlbXBsYXRlOiAnPGRpdiBpZD1cImdhbWUtY2FudmFzXCI+PC9kaXY+JyxcbiAgICBjb21waWxlOiBmdW5jdGlvbihpRWxlLCBpQXR0cnMpIHtcbiAgICAgIHJldHVybiBsaW5rRm47XG4gICAgfVxuICB9XG59XG5cblxuXSk7XG4iLCJcbm1vZHVsZS5leHBvcnRzID1cbmFuZ3VsYXIubW9kdWxlKCdhcHAuZ2FtZScsIFsndWkucm91dGVyJ10pXG4uY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAkc3RhdGVQcm92aWRlclxuICAgIC5zdGF0ZSgnZ2FtZScsIHtcbiAgICAgIHVybDogJy9nYW1lJyxcbiAgICAgIHRlbXBsYXRlOiAnPGRpdj5cXFxuICAgICAgICA8ZGl2IHBoYXNlci1jYW52YXM+PC9kaXY+XFxcbiAgICAgIDwvZGl2PicsXG5cbiAgICB9KVxufV0pO1xuXG5yZXF1aXJlKCcuL2dhbWVfY2FudmFzLmpzJylcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsW1xuICAgICd1aS5yb3V0ZXInLFxuICAgIHJlcXVpcmUoJy4vZ2FtZScpLm5hbWVcbl0pXG4uY29uZmlnKFsnJHVybFJvdXRlclByb3ZpZGVyJyxmdW5jdGlvbigkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgJHVybFJvdXRlclByb3ZpZGVyXG4gICAgLm90aGVyd2lzZSgnL2dhbWUnKTtcbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=